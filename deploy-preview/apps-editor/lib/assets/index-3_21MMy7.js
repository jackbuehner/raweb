import{d as oe,c as $,u as H,a as ie,w as O,r as E,o as R,b as le,i as ue,e as pe,f as ce,g as de,h as T,j as d,k as l,l as a,T as fe,m as g,n as C,s as b,N as me,p as ve,q as p,I as Q,F as D,t as he,v as z,P as ye,x as ge,y as M,z as L,A as be,B as i,C as f,D as P,E as G,G as J,H as we,_ as ke,J as Se,K as Ee,L as Re,M as Te,O as Pe,Q as _e,S as Ae,R as Ce,U as K,V as De,W as Me,X as Le,Y as Ve}from"./shared-BRNNVUM8.js";import{N as He}from"./404-DouQRs8j.js";const Be={id:"appContent"},Ne={id:"page"},We={key:1},xe={style:{display:"flex",gap:"8px","align-items":"center"}},j="https://github.com/kimmknight/raweb/wiki/Trusting-the-RAWeb-server-(Fix-security-error-5003)",Ue=oe({__name:"App",setup(n){const m=HTMLDialogElement.prototype.requestClose!==void 0,o=$({get:()=>!1,set:()=>{}}),u=ce(),c=H(),_={mergeTerminalServers:m===!1?o:M,hidePortsWhenPossible:L},{data:A,loading:Z,error:ee,refresh:N}=ie(c.iisBase,_);let v=null;O(M,async(s,e)=>{if(s===v)return;const{error:t}=await N(_);t.value!==null?(v===null&&(v=e),M.value=v):v=null});let h=null;O(L,async(s,e)=>{if(s===h)return;const{error:t}=await N(_);t.value!==null?(h===null&&(h=e),L.value=h):h=null});const W=E(!1),x=E(!1);async function te(s){if(s.data.type==="fetch-queue"){const e=s.data.backgroundFetchQueueLength>0;x.value=e}}R(()=>{le(te).then(s=>{s==="SSL_ERROR"&&(W.value=!0)})});const U=E(!1);ue.then(()=>{U.value=!0});const q=E(!1);R(()=>{q.value=!0});const se=$(()=>q.value&&A.value&&!ee.value&&U.value);pe(()=>{se.value&&be()}),R(()=>{const s=window.matchMedia("(prefers-reduced-motion: reduce)");function e(){s.matches}return s.addEventListener("change",e),s.matches,()=>{s.removeEventListener("change",e)}}),u.beforeResolve((s,e,t)=>{const r=window.matchMedia("(prefers-reduced-motion: reduce)").matches;if(!document.startViewTransition||r)return t();const y=document.querySelector(".root-splash-wrapper");if(y&&y.style.display!=="none")return;const k=document.querySelector("main"),S=k?k.querySelector("div"):null;S&&(S.style.overflow="hidden"),document.startViewTransition(()=>{t()}).ready.then(()=>{setTimeout(()=>{k&&S&&(k.scrollTo({top:0,left:0,behavior:"instant"}),S.style.overflow="unset")},130),requestAnimationFrame(()=>{})})});const{updateDetails:F,populateUpdateDetails:ae}=de();R(()=>{ae()});const ne=(()=>{const s=c.policies.signedInUserGlobalAlerts;if(!s)return[];try{const e=JSON.parse(s);return Array.isArray(e)?e.filter(t=>t&&typeof t=="object"&&typeof t.title=="string"||t.title===void 0&&typeof t.message=="string"||t.message===void 0&&(typeof t.linkText=="string"||t.linkText===void 0)&&(typeof t.linkHref=="string"||t.linkHref===void 0)&&(t.type==="information"||t.type==="attention"||t.type===void 0)):[]}catch{return[]}})();function I(s,e){const t=window.open(s,e,"width=1000,height=600,menubar=0,status=0");t?t.focus():alert("Please allow popups for this application")}return(s,e)=>{const t=ge("router-view");return i(),T(D,null,[d(a(fe),{forceVisible:"",loading:x.value||a(Z),update:a(F)},null,8,["loading","update"]),l("div",Be,[a(b)?C("",!0):(i(),g(a(me),{key:0})),l("main",{class:ve({simple:a(b)})},[W.value?(i(),g(a(Q),{key:0,severity:"caution",title:s.$t("securityError503.title"),style:{"border-radius":"0"}},{default:p(()=>[f(P(s.$t("securityError503.message"))+" ",1),e[1]||(e[1]=l("br",null,null,-1)),d(a(G),{variant:"hyperlink",href:j,style:{"margin-left":"-11px","margin-bottom":"-6px"},target:"_blank",onClick:e[0]||(e[0]=J(r=>I(j,"help"),["prevent"]))},{default:p(()=>[f(P(s.$t("securityError503.action")),1)]),_:1})]),_:1},8,["title"])):C("",!0),(i(!0),T(D,null,he(a(ne),(r,y)=>(i(),g(a(Q),{key:y,severity:r.type||"attention",title:r.title,class:"global-alert"},{default:p(()=>[f(P(r.message)+" ",1),r.linkText&&r.linkHref?(i(),T(D,{key:0},[e[2]||(e[2]=l("br",null,null,-1)),d(a(G),{variant:"hyperlink",href:r.linkHref,style:{"margin-left":"-11px","margin-bottom":"-6px"},target:"_blank",onClick:J(re=>I(r.linkHref,r.title||`alert-link-${y}`),["prevent"])},{default:p(()=>[f(P(r.linkText),1)]),_:2},1032,["href","onClick"])],64)):C("",!0)]),_:2},1032,["severity","title"]))),128)),l("div",Ne,[a(A)?(i(),g(t,{key:0},{default:p(({Component:r})=>[(i(),g(we(r),{data:a(A),update:a(F)},null,8,["data","update"]))]),_:1})):(i(),T("div",We,[d(a(z),{variant:"title"},{default:p(()=>e[3]||(e[3]=[f("Loading")])),_:1}),e[5]||(e[5]=l("br",null,null,-1)),e[6]||(e[6]=l("br",null,null,-1)),l("div",xe,[d(a(ye),{size:24}),d(a(z),{style:{"font-weight":"500"}},{default:p(()=>e[4]||(e[4]=[f("Please wait...")])),_:1})])]))])],2)])],64)}}}),qe=ke(Ue,[["__scopeId","data-v-1e2366ea"]]),Fe=[{path:"/apps",component:Re},{path:"/devices",component:Te},{path:"/favorites",component:Pe},{path:"/policies",component:_e},{path:"/settings",component:Ae},{path:"/simple",component:Ce},{path:"/",redirect(n){return V()}},{path:"/:pathMatch(.*)*",component:He,beforeEnter:(n,m,o)=>{if(n.path.endsWith("/index.html")){const u=n.path.slice(0,-10)||"/",c=new URL(document.baseURI.replace("/index.html","/")).pathname;return u===c&&(console.log(c.slice(0,-1)+V()),window.location.href=c.slice(0,-1)+V()),o(u)}if(n.path.endsWith(".html")){const u=n.path.slice(0,-5);return o(u)}o()}}],X=CSS.supports("position-area","center center");function V(){return b.value?"/simple":K.value&&X?"/favorites":"/apps"}const B=Se({history:Ee(),routes:Fe});B.beforeEach((n,m,o)=>{if(!b.value&&n.path==="/simple")return o("/favorites");if(b.value&&["/apps","/devices","/favorites"].includes(n.path))return o("/simple");if((!K.value||!X)&&n.path==="/favorites")return o("/apps");if(!H().authUser.isLocalAdministrator&&n.path==="/policies")return o("/favorites");o()});const Y=De();await H(Y).fetchData();const w=Me(Le(qe));w.use(Y);w.use(B);w.use(Ve);w.directive("swap",(n,m)=>{n.parentNode&&(n.outerHTML=m.value)});await B.isReady();w.mount("#app");
